<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SOAR TN Requests</title>

<!-- EmailJS v4 -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<!-- Confetti -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
emailjs.init("YOUR_PUBLIC_KEY"); // ðŸ”´ REQUIRED
</script>

<style>
body{
margin:0;font-family:Arial;background:linear-gradient(-45deg,#eef3ff,#e8fff2);
background-size:400% 400%;animation:bg 15s infinite;
}
@keyframes bg{0%{background-position:0%}50%{background-position:100%}100%{background-position:0%}}

#frame{
margin:80px auto;max-width:1000px;padding:50px;
border:8px solid black;border-radius:25px;position:relative;
}

#logoRow{
display:flex;align-items:center;justify-content:center;
gap:20px;margin-bottom:20px;
font-size:40px;font-weight:bold;
}

#logoRow img{height:80px}

button{
padding:15px 25px;margin:10px;font-size:16px;
border:none;border-radius:8px;cursor:pointer;
background:#0078D4;color:white;
}
button:hover{background:#005A9E}

.modal{
display:none;position:fixed;inset:0;
background:rgba(0,0,0,.6);
align-items:center;justify-content:center;
}
.modal-content{
background:white;padding:25px;border-radius:10px;
width:95%;max-width:550px;
}

input,select,textarea{
width:100%;padding:10px;margin-bottom:10px;
}

</style>
</head>

<body>

<div id="frame">

<div id="logoRow">
<span>SOAR</span>
<img src="logo.png">
<span>TN</span>
</div>

<h2 style="text-align:center">Request Portal</h2>

<div style="text-align:center">
<button onclick="openModal('maintenance')">Maintenance</button>
<button onclick="openModal('service')">Service</button>
<button onclick="openModal('expense')">Expense</button>
<button onclick="openModal('ot')">OT</button>
</div>
</div>

<!-- MODALS -->

<div id="maintenance" class="modal">
<div class="modal-content">
<h3>Maintenance Request</h3>
<input id="m_name" placeholder="Requested By">
<input id="m_email" placeholder="Your Email">
<select id="m_house">
<option>Lee House</option><option>Alcoa House</option>
<option>Cusick House</option><option>Countryside House</option>
<option>Cherokee House</option><option>Dell House</option>
<option>Gladstone House</option><option>Glascock House</option>
<option>Jett House</option><option>May House</option>
<option>Merritt House</option><option>Emma House</option>
<option>Wright House</option><option>Raulston House</option>
<option>Louisville House</option>
</select>
<textarea id="m_desc" placeholder="Work Description"></textarea>
<button onclick="submitMaintenance()">Submit</button>
<button onclick="closeAll()">Cancel</button>
</div>
</div>

<div id="service" class="modal">
<div class="modal-content">
<h3>Service Request</h3>
<input id="s_name" placeholder="Name">
<input id="s_email" placeholder="Email">
<select id="s_dept">
<option value="soarmedicaldepartment@soartn.org">Medical</option>
<option value="programmanagers@soartn.org">Program</option>
<option value="finance@soartn.org">Finance</option>
<option value="soarhr@soartn.org">Compliance</option>
<option value="soarhr@soartn.org">Payroll</option>
<option value="soarhr@soartn.org">IT</option>
<option value="soarhr@soartn.org">Recruiting</option>
<option value="soarhr@soartn.org">HR</option>
<option value="soarhr@soartn.org">Other</option>
</select>
<textarea id="s_desc"></textarea>
<button onclick="submitService()">Submit</button>
<button onclick="closeAll()">Cancel</button>
</div>
</div>

<div id="expense" class="modal">
<div class="modal-content">
<h3>Expense Request</h3>
<input id="e_name" placeholder="Name">
<input id="e_email" placeholder="Email">
<input id="e_amount" placeholder="Amount">
<textarea id="e_desc"></textarea>
<button onclick="submitExpense()">Submit</button>
<button onclick="closeAll()">Cancel</button>
</div>
</div>

<div id="ot" class="modal">
<div class="modal-content">
<h3>OT Request</h3>
<input id="o_name" placeholder="House Manager">
<input id="o_email" placeholder="HM Email">
<input id="o_emp" placeholder="Employee">
<input type="date" id="o_date">
<textarea id="o_reason"></textarea>
<button onclick="submitOT()">Submit</button>
<button onclick="closeAll()">Cancel</button>
</div>
</div>

<script>
function ticket(){return "SOAR-"+Date.now()}
function confettiGo(){confetti({particleCount:120,spread:90})}
function openModal(id){document.getElementById(id).style.display="flex"}
function closeAll(){document.querySelectorAll('.modal').forEach(m=>m.style.display="none")}

function send(template,data){
emailjs.send("service_soar",template,data)
.then(()=>confettiGo())
.catch(e=>alert(e.text))
}

function submitMaintenance(){
const t=ticket()
send("template_maintenance",{
ticket:t,
from_name:m_name.value,
from_email:m_email.value,
to_email:"soarhr@soartn.org",
cc_email:"cherylhintz@soartn.org,alishasanders@soartn.org,kobypresley@soartn.org",
details:`House: ${m_house.value}\n${m_desc.value}`
})
generatePDF(t)
closeAll()
}

function submitService(){
send("template_service",{
ticket:ticket(),
from_name:s_name.value,
from_email:s_email.value,
to_email:"soarhr@soartn.org",
cc_email:s_dept.value,
details:s_desc.value
})
closeAll()
confettiGo()
}

function submitExpense(){
send("template_expense",{
ticket:ticket(),
from_name:e_name.value,
from_email:e_email.value,
to_email:"finance@soartn.org",
cc_email:"soarhr@soartn.org",
details:`$${e_amount.value}\n${e_desc.value}`
})
closeAll()
confettiGo()
}

function submitOT(){
send("template_ot",{
ticket:ticket(),
from_name:o_name.value,
from_email:o_email.value,
to_email:"nikkigoodwin@soartn.org,cherylhintz@soartn.org",
cc_email:"soarhr@soartn.org",
details:`Employee: ${o_emp.value}\n${o_reason.value}`
})
closeAll()
confettiGo()
}

function generatePDF(ticket){
const {jsPDF}=window.jspdf
const pdf=new jsPDF()
pdf.text(`Maintenance Request\nTicket: ${ticket}`,10,10)
pdf.save(`${ticket}.pdf`)
}
</script>

</body>
</html>
